{"version":3,"sources":["common/api/watch-history.js","common/api/popup-history.js","pages/admin/reports/reports-view.js"],"names":["BASE_URL","APIServerURL","WahtchHistoryAPI","getAll","page","perPage","userId","url","axios","get","getOne","id","remove","delete","PopupHistoryAPI","ReportView","match","history","addToastAction","user","params","reportId","useState","selectedId","setSelectedId","currentData","setCurrentData","removePopupConfirmTarget","setRemovePopupConfirmTarget","removePopupConfirmVisibility","setRemovePopupConfirmVisibility","removeConfirmTarget","setRemoveConfirmTarget","removeConfirmVisibility","setRemoveConfirmVisibility","useEffect","WatchhistoryApis","then","res","data","e","error","ToastStatus","Danger","Container","Row","Col","Button","variant","onClick","goBack","className","to","title","fullName","substr","timeFromNow","createdAt","size","aria-disabled","color","isFinished","icon","faCheck","faExclamationCircle","role","UserRole","Admin","target","Table","popupHistories","map","item","index","dateToLocalString","isClicked","updatedAt","faUserCheck","faTrash","visible","setVisibility","label","onConfirm","Success","catch","PopuphistoryApis","defaultProps","withRouter","connectToasts","connectAuth"],"mappings":"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","file":"static/js/2.099ec3d5.chunk.js","sourcesContent":["import axios from './configuration';\r\n\r\n// Constants\r\nimport { APIServerURL } from '../constants/default-values';\r\n\r\nconst BASE_URL = `${APIServerURL}/watch-histories`;\r\nconst WahtchHistoryAPI =  {\r\n    getAll: ({ page, perPage, userId }) => {\r\n        let url = `${BASE_URL}?page=${page}&perPage=${perPage}`;\r\n        if (userId) {\r\n            url += `&userId=${userId}`\r\n        }\r\n        return axios.get(url);\r\n    },\r\n    getOne: ({id}) => {\r\n        return axios.get(`${BASE_URL}/${id}`)\r\n    },\r\n    remove: ({id}) => {\r\n        const url = `${BASE_URL}/${id}`;\r\n\r\n        return axios.delete(url);\r\n    },\r\n}\r\n\r\nexport default WahtchHistoryAPI;\r\n","import axios from './configuration';\r\n\r\n// Constants\r\nimport { APIServerURL } from '../constants/default-values';\r\n\r\nconst BASE_URL = `${APIServerURL}/popup-histories`;\r\nconst PopupHistoryAPI =  {\r\n    getOne: ({id}) => {\r\n        return axios.get(`${BASE_URL}/${id}`)\r\n    },\r\n    remove: ({id}) => {\r\n        const url = `${BASE_URL}/${id}`;\r\n\r\n        return axios.delete(url);\r\n    },\r\n}\r\n\r\nexport default PopupHistoryAPI;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { withRouter } from 'react-router';\r\nimport Table from 'react-bootstrap/Table';\r\nimport { Button, Container, Row, Col } from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faTrash, faExclamationCircle, faCheck, faUserCheck } from '@fortawesome/free-solid-svg-icons';\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport { timeFromNow, dateToLocalString } from '../../../common/utils/common';\r\nimport { connectToasts, connectAuth } from '../../../common/redux/connects';\r\nimport { ToastStatus } from '../../../common/enums/toast';\r\nimport { ConfirmPopover } from '../../../components/common/popover';\r\n\r\nimport WatchhistoryApis from '../../../common/api/watch-history';\r\nimport PopuphistoryApis from '../../../common/api/popup-history';\r\nimport { UserRole } from '../../../common/enums/auth';\r\n\r\nfunction ReportView ({match, history, addToastAction, user}) {\r\n    const id = match.params.reportId\r\n    const [selectedId, setSelectedId] = useState(0);\r\n    const [currentData, setCurrentData] = useState(null)\r\n\r\n\r\n    const [removePopupConfirmTarget, setRemovePopupConfirmTarget] = useState(null);\r\n    const [removePopupConfirmVisibility, setRemovePopupConfirmVisibility] = useState(false);\r\n\r\n    const [removeConfirmTarget, setRemoveConfirmTarget] = useState(null);\r\n    const [removeConfirmVisibility, setRemoveConfirmVisibility] = useState(false);\r\n\r\n    const refreshPage = () => {\r\n        WatchhistoryApis\r\n            .getOne({id: id})\r\n            .then(res => {\r\n                setCurrentData(res.data)\r\n            }, e =>  addToastAction(\"Error\", e.error, ToastStatus.Danger) )\r\n    }\r\n\r\n    const removeHistory = () => {\r\n        WatchhistoryApis\r\n            .remove({id: id})\r\n            .then(() => {\r\n                addToastAction(\"Alert\", 'Remove success', ToastStatus.Success);\r\n                history.goBack();\r\n            })\r\n            .catch(e => {\r\n                addToastAction(\"Alert\", e.error, ToastStatus.Danger)\r\n            })\r\n    }\r\n\r\n    const removePopupHistory = () => {\r\n        PopuphistoryApis\r\n            .remove({id: selectedId})\r\n            .then(() => {\r\n                addToastAction(\"Alert\", 'Remove success', ToastStatus.Success);\r\n                setSelectedId(0)\r\n            })\r\n            .catch(e => {\r\n                addToastAction(\"Alert\", e.error, ToastStatus.Danger)\r\n            })\r\n    }\r\n\r\n    useEffect(() => {\r\n        refreshPage();\r\n    }, [ id, selectedId ])\r\n\r\n    if(!currentData) {\r\n        return null\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <Row>\r\n                <Col>\r\n                    <Button variant='link' onClick={() => history.goBack()}>\r\n                        <span className='h6'>Back</span>\r\n                    </Button>\r\n                </Col>\r\n            </Row>\r\n\r\n            <Row className='mb-5'>\r\n                <Col>\r\n                    <h1 className='text-center text-primary'>Report</h1>\r\n                </Col>\r\n            </Row>\r\n            <Row className=''>\r\n                <Col>\r\n                    <p>\r\n                        User name: &nbsp;\r\n                        <Link to={`/admin/users/view/${currentData.user.id}`} title={currentData.user.fullName}>\r\n                            {`${currentData.user.fullName}`.substr(0, 20) }\r\n                        </Link>\r\n                    </p>\r\n                    <p>Played at: {timeFromNow(currentData.createdAt)}</p>\r\n                    <div>\r\n                        <p className=\"float-left\">\r\n                            Finished: \r\n                            <FontAwesomeIcon \r\n                                className=\"cursor-pointer ml-2\" \r\n                                size='lg'\r\n                                aria-disabled\r\n                                color={currentData.isFinished ? \"green\" : \"red\"}\r\n                                icon={currentData.isFinished ? faCheck : faExclamationCircle }\r\n                                title={currentData.isFinished ? \"Finished\" : \"Didnt Finished\"}\r\n                            />\r\n                        </p>\r\n                        {\r\n                            user.role === UserRole.Admin &&\r\n                            <p className=\"float-right mr-2\">\r\n                                <Button \r\n                                    variant=\"outline-danger\" size=\"sm\" \r\n                                    onClick={(e) => [setRemoveConfirmTarget(e.target), setRemoveConfirmVisibility(true)]}\r\n                                >Remove</Button>{' '}\r\n                            </p>\r\n                        }\r\n                    </div>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col>\r\n                    <Table>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Started At</th>\r\n                                <th>Clicked At</th>\r\n                                <th className=\"text-center\">Clicked</th>\r\n                                {\r\n                                    user.role === UserRole.Admin &&\r\n                                    <th className=\"text-center\">Actions</th>\r\n                                }\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {\r\n                                currentData.popupHistories.map((item, index) => (\r\n                                    <tr key={index}>\r\n                                        <td>{index + 1}</td>\r\n                                        {/* <td>\r\n                                            <Link to={`/admin/users/view/${item.user.id}`} title={item.user.fullName}>\r\n                                                { item.user.fullName }\r\n                                            </Link>\r\n                                        </td> */}\r\n                                        <td>{dateToLocalString(item.createdAt)}</td>\r\n                                        <td>{item.isClicked && dateToLocalString(item.updatedAt)}</td>\r\n                                        {/* <td className=\"text-center\">\r\n                                            <Link to={`/admin/videos/view/${item.video.id}`} title={item.video.title}>\r\n                                                { `${item.video.title}`.substr(0, 10) }\r\n                                            </Link>\r\n                                        </td> */}\r\n                                        <td className=\"text-center\">\r\n                                            <FontAwesomeIcon \r\n                                                className=\"cursor-pointer ml-2\" \r\n                                                size='lg'\r\n                                                aria-disabled\r\n                                                color={item.isClicked ? 'green': 'red'}\r\n                                                icon={item.isClicked ? faUserCheck : faExclamationCircle }\r\n                                                title={item.isClicked ? \"Clicked\" : \"Didnt Clicked\"}\r\n                                            />\r\n                                        </td>\r\n                                        {\r\n                                            user.role === UserRole.Admin &&\r\n                                            <td className=\"text-center\">\r\n                                                <FontAwesomeIcon className='cursor-pointer text-danger ml-2' size='lg' icon={faTrash}\r\n                                                    onClick={(e) => ([\r\n                                                        setSelectedId(item.id),\r\n                                                        setRemovePopupConfirmVisibility(true),\r\n                                                        setRemovePopupConfirmTarget(e.target)\r\n                                                    ])}\r\n                                                    title=\"Remove\"\r\n                                                />\r\n                                            </td>\r\n                                        }\r\n                                    </tr>\r\n                                ))\r\n                            }\r\n                        </tbody>\r\n                    </Table>\r\n                </Col>\r\n            </Row>\r\n            <ConfirmPopover \r\n                visible={removeConfirmVisibility} \r\n                target={removeConfirmTarget}\r\n                setVisibility={() => setRemoveConfirmVisibility(false)}\r\n                label=\"Are you sure to delete this report?\"\r\n                onConfirm={removeHistory}\r\n            />\r\n            <ConfirmPopover \r\n                visible={removePopupConfirmVisibility} \r\n                target={removePopupConfirmTarget}\r\n                setVisibility={() => setRemovePopupConfirmVisibility(false)}\r\n                label=\"Are you sure to delete this popup result?\"\r\n                onConfirm={removePopupHistory}\r\n            />\r\n        </Container>\r\n    )\r\n}\r\n\r\nReportView.propTypes = {\r\n    id: PropTypes.number\r\n};\r\n\r\nReportView.defaultProps = {\r\n    id: 0\r\n};\r\n\r\nexport default withRouter(connectToasts(connectAuth(ReportView)));\r\n"],"sourceRoot":""}